{
  "endpoint": {
    "method": "POST",
    "path": "/communities",
    "description": "Criar uma nova comunidade. Suporta três formas: com upload de arquivo de imagem, com URL de imagem, ou sem imagem.",
    "requiresAuth": true,
    "authentication": {
      "type": "Bearer Token (JWT)",
      "header": "Authorization: Bearer <token>",
      "note": "Token JWT obtido no login"
    }
  },
  "requestOptions": {
    "option1": {
      "name": "Com Upload de Arquivo de Imagem (Recomendado)",
      "contentType": "multipart/form-data",
      "description": "Enviar arquivo de imagem junto com os dados da comunidade",
      "headers": {
        "Authorization": "Bearer <seu-token-jwt>",
        "Content-Type": "multipart/form-data (definido automaticamente pelo browser)"
      },
      "body": {
        "name": {
          "type": "string",
          "required": true,
          "description": "Nome único da comunidade",
          "example": "Comunidade PRF 2024",
          "validation": "Não pode estar vazio, deve ser único no sistema"
        },
        "focus": {
          "type": "string",
          "required": true,
          "description": "Foco/tema da comunidade",
          "example": "PRF",
          "examples": ["PRF", "ENEM", "História", "Medicina", "Direito", "ESA"]
        },
        "description": {
          "type": "string",
          "required": false,
          "description": "Descrição detalhada da comunidade",
          "example": "Comunidade para estudos focados em PRF 2024"
        },
        "visibility": {
          "type": "enum",
          "required": true,
          "description": "Visibilidade da comunidade",
          "enum": ["PUBLIC", "PRIVATE"],
          "example": "PUBLIC",
          "PUBLIC": "Qualquer pessoa pode ver e entrar",
          "PRIVATE": "Apenas membros podem ver, entrada apenas por convite"
        },
        "image": {
          "type": "file",
          "required": false,
          "description": "Arquivo de imagem da comunidade",
          "acceptedFormats": ["image/jpeg", "image/jpg", "image/png", "image/gif", "image/webp"],
          "maxSize": "5MB",
          "processing": "Redimensionada para 800x600px e otimizada automaticamente pelo Cloudinary"
        }
      },
      "example": {
        "javascript": "const formData = new FormData();\nformData.append('name', 'Comunidade PRF 2024');\nformData.append('focus', 'PRF');\nformData.append('description', 'Estudos para PRF');\nformData.append('visibility', 'PUBLIC');\nformData.append('image', fileInput.files[0]);\n\nconst response = await fetch('https://seu-backend.railway.app/communities', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${token}`\n  },\n  body: formData\n});\n\nconst data = await response.json();",
        "react": "const handleSubmit = async (e) => {\n  e.preventDefault();\n  \n  const formData = new FormData();\n  formData.append('name', communityData.name);\n  formData.append('focus', communityData.focus);\n  formData.append('description', communityData.description);\n  formData.append('visibility', communityData.visibility);\n  formData.append('image', imageFile);\n  \n  const response = await fetch('/communities', {\n    method: 'POST',\n    headers: { 'Authorization': `Bearer ${token}` },\n    body: formData\n  });\n  \n  const result = await response.json();\n};"
      }
    },
    "option2": {
      "name": "Com URL de Imagem",
      "contentType": "application/json",
      "description": "Enviar URL de uma imagem já hospedada",
      "headers": {
        "Authorization": "Bearer <seu-token-jwt>",
        "Content-Type": "application/json"
      },
      "body": {
        "name": {
          "type": "string",
          "required": true,
          "example": "Comunidade PRF 2024"
        },
        "focus": {
          "type": "string",
          "required": true,
          "example": "PRF"
        },
        "description": {
          "type": "string",
          "required": false,
          "example": "Comunidade para estudos de PRF"
        },
        "visibility": {
          "type": "enum",
          "required": true,
          "enum": ["PUBLIC", "PRIVATE"],
          "example": "PUBLIC"
        },
        "image": {
          "type": "string",
          "required": false,
          "description": "URL completa da imagem",
          "example": "https://exemplo.com/imagem.png"
        }
      },
      "example": {
        "javascript": "const response = await fetch('https://seu-backend.railway.app/communities', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${token}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    name: 'Comunidade PRF 2024',\n    focus: 'PRF',\n    description: 'Estudos para PRF',\n    visibility: 'PUBLIC',\n    image: 'https://exemplo.com/imagem.png'\n  })\n});\n\nconst data = await response.json();"
      }
    },
    "option3": {
      "name": "Sem Imagem",
      "contentType": "application/json",
      "description": "Criar comunidade sem imagem (pode adicionar depois)",
      "headers": {
        "Authorization": "Bearer <seu-token-jwt>",
        "Content-Type": "application/json"
      },
      "body": {
        "name": {
          "type": "string",
          "required": true,
          "example": "Comunidade PRF 2024"
        },
        "focus": {
          "type": "string",
          "required": true,
          "example": "PRF"
        },
        "description": {
          "type": "string",
          "required": false,
          "example": "Comunidade para estudos de PRF"
        },
        "visibility": {
          "type": "enum",
          "required": true,
          "enum": ["PUBLIC", "PRIVATE"],
          "example": "PUBLIC"
        }
      },
      "example": {
        "javascript": "const response = await fetch('https://seu-backend.railway.app/communities', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${token}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    name: 'Comunidade PRF 2024',\n    focus: 'PRF',\n    description: 'Estudos para PRF',\n    visibility: 'PUBLIC'\n  })\n});\n\nconst data = await response.json();"
      }
    }
  },
  "response": {
    "success": {
      "statusCode": 201,
      "description": "Comunidade criada com sucesso",
      "body": {
        "success": true,
        "data": {
          "id": "uuid-da-comunidade",
          "name": "Comunidade PRF 2024",
          "focus": "PRF",
          "description": "Comunidade para estudos focados em PRF 2024",
          "image": "https://res.cloudinary.com/dgdefptw3/image/upload/v1234567890/community-images/abc123.jpg",
          "visibility": "PUBLIC",
          "ownerId": "uuid-do-criador",
          "createdAt": "2024-01-15T10:30:00.000Z"
        }
      },
      "notes": [
        "O criador automaticamente se torna membro e dono da comunidade",
        "Se uma imagem foi enviada, ela já está processada e disponível",
        "O campo 'image' será null se nenhuma imagem foi fornecida"
      ]
    },
    "errors": {
      "400": {
        "description": "Bad Request - Dados inválidos",
        "scenarios": [
          {
            "message": "Comunidade com o nome \"{nome}\" já existe",
            "cause": "Nome de comunidade duplicado",
            "solution": "Escolher um nome diferente"
          },
          {
            "message": "Tipo de arquivo não permitido. Use JPG, PNG, GIF ou WebP",
            "cause": "Formato de imagem inválido",
            "solution": "Enviar imagem em formato JPG, PNG, GIF ou WebP"
          },
          {
            "message": "Arquivo muito grande. Tamanho máximo: 5MB",
            "cause": "Arquivo excede 5MB",
            "solution": "Redimensionar ou comprimir a imagem"
          },
          {
            "message": "Nenhum arquivo foi enviado",
            "cause": "Campo 'image' esperado mas não recebido",
            "solution": "Verificar se o arquivo está sendo enviado corretamente"
          }
        ],
        "example": {
          "statusCode": 400,
          "message": "Comunidade com o nome \"Comunidade PRF 2024\" já existe",
          "error": "Bad Request"
        }
      },
      "401": {
        "description": "Unauthorized - Não autenticado",
        "message": "Token JWT inválido ou expirado",
        "solution": "Fazer login novamente para obter um novo token",
        "example": {
          "statusCode": 401,
          "message": "Unauthorized"
        }
      },
      "500": {
        "description": "Internal Server Error - Erro no servidor",
        "scenarios": [
          {
            "message": "Erro ao fazer upload da imagem: {detalhes}",
            "cause": "Erro no Cloudinary ou processamento",
            "solution": "Tentar novamente ou usar URL de imagem"
          }
        ]
      }
    }
  },
  "businessRules": {
    "ownership": "O criador automaticamente se torna dono e membro da comunidade",
    "naming": "Nomes de comunidades devem ser únicos no sistema",
    "imageProcessing": {
      "upload": "Imagens enviadas são processadas pelo Cloudinary",
      "dimensions": "Redimensionadas para 800x600px",
      "optimization": "Otimizadas automaticamente (WebP quando possível)",
      "folder": "Armazenadas em 'community-images/' no Cloudinary",
      "url": "URL permanente retornada e salva no banco"
    },
    "visibility": {
      "PUBLIC": {
        "description": "Qualquer pessoa pode ver e entrar",
        "discoverable": "Aparece em buscas e listagens públicas",
        "joinMethod": "Qualquer usuário autenticado pode entrar diretamente"
      },
      "PRIVATE": {
        "description": "Apenas membros podem ver",
        "discoverable": "Não aparece em buscas públicas",
        "joinMethod": "Apenas através de convite de membros"
      }
    }
  },
  "frontendIntegration": {
    "recommendedApproach": "Usar Option 1 (Upload de arquivo) para melhor experiência do usuário",
    "formExample": {
      "html": "<form id=\"createCommunityForm\">\n  <input type=\"text\" name=\"name\" placeholder=\"Nome da comunidade\" required />\n  <input type=\"text\" name=\"focus\" placeholder=\"Foco (ex: PRF)\" required />\n  <textarea name=\"description\" placeholder=\"Descrição\"></textarea>\n  <select name=\"visibility\" required>\n    <option value=\"PUBLIC\">Pública</option>\n    <option value=\"PRIVATE\">Privada</option>\n  </select>\n  <input type=\"file\" name=\"image\" accept=\"image/jpeg,image/jpg,image/png,image/gif,image/webp\" />\n  <button type=\"submit\">Criar Comunidade</button>\n</form>",
      "javascript": "document.getElementById('createCommunityForm').addEventListener('submit', async (e) => {\n  e.preventDefault();\n  \n  const formData = new FormData(e.target);\n  \n  const response = await fetch('/communities', {\n    method: 'POST',\n    headers: {\n      'Authorization': `Bearer ${token}`\n    },\n    body: formData\n  });\n  \n  const data = await response.json();\n  \n  if (data.success) {\n    console.log('Comunidade criada:', data.data);\n    // Redirecionar ou atualizar UI\n  } else {\n    console.error('Erro:', data.message);\n  }\n});"
    },
    "validation": {
      "frontend": [
        "Validar nome não vazio",
        "Validar foco não vazio",
        "Validar tipo de arquivo antes do upload",
        "Validar tamanho do arquivo (máx 5MB)",
        "Mostrar preview da imagem antes de enviar"
      ],
      "backend": "Todas as validações do frontend são revalidadas no backend"
    },
    "uiRecommendations": [
      "Mostrar preview da imagem selecionada",
      "Indicar progresso durante upload",
      "Desabilitar botão de submit durante processamento",
      "Mostrar mensagens de erro claras",
      "Redirecionar para página da comunidade após criação"
    ]
  },
  "dataModel": {
    "Community": {
      "id": {
        "type": "string (UUID)",
        "description": "Identificador único da comunidade",
        "generated": "Automaticamente pelo sistema"
      },
      "name": {
        "type": "string",
        "description": "Nome da comunidade",
        "unique": true,
        "required": true
      },
      "focus": {
        "type": "string",
        "description": "Foco/tema da comunidade",
        "required": true,
        "examples": ["PRF", "ENEM", "História", "Medicina"]
      },
      "description": {
        "type": "string | null",
        "description": "Descrição detalhada",
        "required": false
      },
      "image": {
        "type": "string | null",
        "description": "URL da imagem da comunidade",
        "format": "URL completa do Cloudinary",
        "required": false
      },
      "visibility": {
        "type": "enum",
        "values": ["PUBLIC", "PRIVATE"],
        "description": "Visibilidade da comunidade",
        "required": true
      },
      "ownerId": {
        "type": "string (UUID)",
        "description": "ID do criador/dono da comunidade",
        "autoSet": "Automaticamente definido como o usuário autenticado"
      },
      "createdAt": {
        "type": "Date (ISO string)",
        "description": "Data de criação",
        "format": "ISO 8601",
        "autoSet": "Automaticamente definido pelo sistema"
      }
    }
  },
  "nextSteps": {
    "afterCreation": [
      "A comunidade já está criada e o usuário já é membro",
      "A imagem (se fornecida) já está processada e disponível",
      "Para comunidades públicas: outros usuários podem entrar",
      "Para comunidades privadas: o dono pode convidar membros",
      "O dono pode atualizar a imagem usando POST /communities/:id/image"
    ],
    "relatedEndpoints": [
      {
        "endpoint": "GET /communities/:id",
        "description": "Ver detalhes da comunidade criada"
      },
      {
        "endpoint": "POST /communities/:id/image",
        "description": "Atualizar imagem da comunidade"
      },
      {
        "endpoint": "POST /communities/invite",
        "description": "Convidar usuários para a comunidade"
      }
    ]
  },
  "examples": {
    "completeFlow": {
      "description": "Exemplo completo: criar comunidade com upload de imagem",
      "step1": {
        "action": "Usuário seleciona imagem e preenche formulário",
        "code": "const formData = new FormData();\nformData.append('name', 'Comunidade PRF 2024');\nformData.append('focus', 'PRF');\nformData.append('description', 'Estudos para PRF');\nformData.append('visibility', 'PUBLIC');\nformData.append('image', fileInput.files[0]);"
      },
      "step2": {
        "action": "Enviar requisição",
        "code": "const response = await fetch('/communities', {\n  method: 'POST',\n  headers: { 'Authorization': `Bearer ${token}` },\n  body: formData\n});"
      },
      "step3": {
        "action": "Processar resposta",
        "code": "const data = await response.json();\nif (data.success) {\n  // Comunidade criada!\n  console.log('ID:', data.data.id);\n  console.log('Imagem:', data.data.image);\n  // Redirecionar para /communities/{id}\n}"
      }
    }
  }
}

